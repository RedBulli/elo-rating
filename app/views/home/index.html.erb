<div>
  <div>
    <%= form_tag(url_for(action: 'create', controller: 'frames'), method: "POST", class: "pure-form") do %>
      <legend>New result</legend>
      <fieldset>
        <label for="winner">Winner</label>
        <input type="text" name="winner" list="player-suggestions">
        <input type="radio" id="breaker-winner" name="breaker" value="winner">
        <label for="breaker-winner">Breaker</label>
      </fieldset>
      <fieldset>
        <label for="loser">Loser</label>
        <input type="text" name="loser" list="player-suggestions">
        <input type="radio" id="breaker-loser" name="breaker" value="loser">
        <label for="breaker-loser">Breaker</label>
      </fieldset>
      <fieldset>
        <label for="game_type">Game</label>
        <select name="game_type">
          <% @game_types.each do |game_type| %>
            <option value="<%= game_type[:value] %>">
              <%= game_type[:name] %>
            </option>
          <%end %>
        </select>
      </fieldset>
      <fieldset>
        <button class="pure-button pure-button-primary">Save result</button>
      </fieldset>
    <% end %>
  </div>
  <div class="pure-g">
    <div class="pure-u-1 pure-u-md-1-3">
      <h2>Ratings</h2>
      <ol>
        <% @established_ratings.each do |player| %>
          <li><%= link_to player.name, player %> (<%=player.elo.rating.to_i%>) [<%=player.frames_count%>]</li>
        <%end %>
      </ol>
    </div>
    <div class="pure-u-1 pure-u-md-1-3">
      <h2>Provisional ratings (under 15 frames)</h2>
      <ol>
        <% @provisional_ratings.each do |player| %>
          <li><%= link_to player.name, player %> (<%=player.elo.rating.to_i%>) [<%=player.frames_count%>]</li>
        <%end %>
      </ol>
      <p>Provisional ratings will change 3 times faster when provisional</p>
    </div>
    <div class="pure-u-1 pure-u-md-1-3">
      <ol>
        <% @frames.each do |frame| %>
          <li>
            <%=frame[:created_at].in_time_zone('Helsinki').to_formatted_s(:short)%>
            <% if frame[:breaker_is_winner] %>
              <b><%= link_to frame[:player1].name, frame[:player1] %></b> - <%= link_to frame[:player2].name, frame[:player2] %>
            <% else %>
              <%= link_to frame[:player1].name, frame[:player1] %> - <b><%= link_to frame[:player2].name, frame[:player2] %></b>
            <% end %>
            <% if frame[:deletable] %>
              <%= form_for(frame[:model], method: :delete, data: { confirm: 'Are you sure?' }, html: { class: 'button-form delete' }) do %>
                <button><i class="fa fa-trash"></i></button>
              <% end %>
            <% end %>
          </li>
        <%end %>
      </ol>
    </div>
  </div>
</div>

<datalist id="player-suggestions">
  <% @players.each do |player| %>
    <option value="<%=player.name%>">
  <%end %>
</datalist>
